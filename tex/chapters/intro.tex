\chapter{Wstęp teoretyczny}
\label{ch:wstept}

\section{Koordynacja ruchu robotów}
Koordynacja ruchu robotów jest jednym z fundamentalnych problemów w systemach wielu robotów. \cite{optpriorities}

Kooperacyjne znajdowanie tras (ang. Cooperative Pathfinding) jest problemem planowania w układzie wieloagentowym, w którym to agenci mają za zadanie znaleźć bezkolizyjne drogi do swoich, osobnych celów. Planowanie to odbywa się w oparciu o pełną informację o środowisku oraz trasach pozostałych agentów. \cite{cooppath}

Problem kooperacyjnego znajdowania tras pojawia się często m.in. w grach komputerowych, gdzie należy wyznaczyć drogi dla wielu jednostek, które mogą blokować się wzajemnie. Algorytmy do wyznaczania bezkolizyjnych tras dla wielu agentów (robotów) mogą znaleźć również zastosowanie w szpitalach (np. roboty TUG i HOMER do dostarczania sprzętu na wyposażeniu szpitala \cite{tughomer}) oraz magazynach (np. roboty transportowe w magazynach firmy Amazon \cite{amazonrobots}).

\section{Cel pracy}
Przedmiotem niniejszej pracy jest przegląd metod rozwiązujacych zagadnienie planowania bezkolizyjnych tras dla wielu robotów. Stanowi to również wstęp teoretyczny do zaprojektowania algorytmu i implementacji oprogramowania pozwalającego na symulację działania systemu planowania tras.

Praca skupia się na przypadkach, w których mamy do czynienia ze środowiskiem z dużą liczbą przeszkód (np. zamknięty budynek z licznymi ciasnymi korytarzami), gdzie problem blokowania sią agentów prowadzi często do zakleszczenia. Należy wtedy zastosować nieco inne podejścia niż te, które sprawdzają się w przypadku otwartych środowisk, a które zostały opisane np. w pracach: \cite{roszkowska}, \cite{siemiatkowska}

W niniejszej pracy zajmować będziemy się rozwiązaniem problemu, w którym mamy pełną informację o mapie otoczenia oraz o określonym położeniu początkowym i celu dla każdego z robotów. Zadaniem algorytmu będzie wyznaczenie możliwie najkrótszej bezkolizyjnej trasy dla wszystkich robotów. Należy jednak zaznaczyć, że priorytetem jest dotarcie każdego z robotów do celu bez kolizji z innymi robotami, dopiero później chcemy, aby wyznaczone drogi były możliwie najkrótsze.

\section{Przestrzeń konfiguracyjna}
Przestrzeń konfiguracyjna to formalna, matematyczna przestrzeń będąca zbiorem możliwych stanów danego układu fizycznego.
W zależności od rodzaju i liczby wyróżnionych parametrów stanu przestrzenie konfiguracyjne mogą mieć wiele wymiarów.

\section{Metoda hill-climbing}
Metoda hill-climbing jest rodzajem matematycznej optymalizacji, lokalną metodą przeszukiwania.
Jest to iteracyjny algorytm, który zaczyna w wybranym rozwiązaniu problemu, następnie próbuje znaleźć lepsze rozwiązanie poprzez przyrostowe zmiany pojedynczych elementów rozwiązania.
Jeśli zmiana przynosi lepsze rozwiązanie, jest wprowadzana do nowego rozwiązania.
Kroki algorytmu powtarzane są dotąd, aż żadne ``udoskonalenie'' nie zostaje znalezione.

\section{Metody planowania tras}
Spośród metod wykorzystywanych do planowania tras dla wielu robotów można wyróżnić dwie zasadnicze grupy \cite{latombe}:
\begin{itemize}
	\item {\bf zcentralizowane} - drogi wyznaczane są dla wszystkich agentów na raz (jednocześnie). Metody te potrafią znaleźć wszystkie możliwe rozwiązania (w szczególności to optymalne), ale mają bardzo dużą złożoność obliczeniową ze względu na ogromną przestrzeń przeszukiwania. Z tego powodu wykorzystywane są heurystyki przyspieszające proces obliczania rozwiązania.
	\item {\bf rozproszone} (ang. decoupled lub distributed) - Podejście to dekomponuje zadanie na niezależne lub zależne w niewielkim stopniu problemy dla każdego agenta. Dla każdego robota droga wyznaczana jest osobno, w określonej kolejności, następnie rozwiązywane są konflikty (kolizje dróg). W pewnych przypadkach rozwiązanie może nie zostać znalezione, mimo, iż istnieje. Metody te najczęściej wiążą się z koniecznością przydzielenia priorytetów, co stanowi istotny problem, gdyż od ich wyboru może zależeć zupełność algorytmu. Nie należy mylić tej metody z zagadnieniem typu Non-Cooperative Pathfinding, w którym agenci nie mają wiedzy na temat pozostałych planów i muszą przewidywać przyszłe ruchy pozostałych robotów. W podejściu rozproszonym agenci mają pełną informację na temat stanu pozostałych robotów, lecz wyznaczanie dróg odbywa się w określonej kolejności.
\end{itemize}

\subsection{Metody zcentralizowane}
Zaletami metod zcentralizowanych są:
\begin{itemize}
	\item Planowanie w zbiorowej przestrzeni konfiguracyjnej
	\item Wyznaczenie {\bf optymalnego} rozwiązania
	\item W praktyce: Heurystyka radzi sobie z ogromną złożonością przestrzeni konfiguracyjnej
\end{itemize}

Podejścia (bez gwarancji optymalności):
\begin{itemize}
	\item Potential field techniques - Metoda potencjałowa
	\item Roadmap methods - przeszukiwanie grafu połączeń algorytmem Dijkstry
\end{itemize}

\subsection{Metoda potencjałowa}
Metoda potencjałowa (ang. Potential field techniques) $TODO$

\subsection{Podejście "Decoupled"}
Popularne podejścia omijające planowanie w wysoko wymiarowej zbiorowej przestrzeni konfiguracyjnej to techniki rozproszone i priorytetowane.
Pomimo, że te metody są bardzo efektywne, mają dwie główne wady:
\begin{enumerate}
	\item Nie są zupełne - czasami nie udaje się znaleźć rozwiązania, nawet gdy istnieje.
	\item Wynikowe rozwiązania są często nieoptymalne.
\end{enumerate}

Ponadto nie mówią, jak przypisywać priorytety do pojedynczych robotów.

W artykule \cite{optpriorities} przedstawiono metodę do optymalizowania układu priorytetów dla rozproszonych i priorytetowanych technik planowania.
Proponowana metoda wykonuje randomizowane przeszukiwanie z techniką hill-climbing do znalezienia rozwiązania i do skrócenia całkowitej długości ścieżek.
Technika została zaimplemenotwana i przetestowana na prawdziwych robotach oraz w rozległych testach symulacyjnych.
Wyniki eksperyentu pokazały, że metoda potrafi znacząco zmniejszyć liczbę niepowodzeń i znacznie zmniejszyć całkowitą długość tras dla różnych priorytetowanych i rozproszoncyh metod planowania dróg, nawet dla dużych zespołów robotów.

Algorytm (niezupełny):
\begin{enumerate}
	\item Wyznaczenie optymalnej ścieżki dla każdego robota {\bf niezależnie}
	\item Przydział priorytetów (opcjonalne)
	\item Próba rozwiązania możliwych konfliktów między ścieżkami
\end{enumerate}
% może nie znaleźć istniejącego rozwiązania
Podejścia:
\begin{itemize}
	\item Path coordination
	\item Planning in the configuration time-space: % TODO tłumaczenie
		\begin{itemize}
			\item V-Graph algorithm
			\item Potential fields
			\item A*
		\end{itemize}
\end{itemize}

\subsubsection{Path coordination}
Idea:
\begin{itemize}
	\item Utrzymanie robotów na ich indywidualnych, optymalnych ścieżkach
	\item Pozwolenie na zatrzymanie się, ruch naprzód, a nawet cofanie się, ale tylko {\bf wzdłuż trajektorii} w celu uniknięcia kolizji
\end{itemize}
W praktyce:
\begin{itemize}
	\item Wymagany wariant z ustaleniem priorytetów
	\item Złożoność $O(n \cdot m \cdot log(m))$, m - maksymalna liczba stanów podczas planowania % n - liczba robotów, m - maksymalna liczba stanów podczas planowania w konfiguracji time-space
\end{itemize}

\subsubsection{Konieczność wyboru priorytetów}
\begin{figure}[htp]
	\centering
	\includegraphics[width=\textwidth,keepaspectratio]{img/article1/fig1}
	\caption{Sytuacja, w której żadne rozwiązanie nie zostanie znalezione, jeśli robot 1 ma wyższy priorytet niż robot 2}
\end{figure}

\subsubsection{Zastosowanie A* w planowaniu dróg dla wielu robotów}
Algorytm:
\begin{itemize}
	\item Przypisanie priorytetów do poszczególnych robotów
	\item Wykonywanie kroków A* z rozpatrywaniem czasu i przestrzeni - podział otoczenia na siatkę pól, zapisywanie prawdopodobieństwa zajętości pola w danej chwili
\end{itemize}
Złożoność:
\begin{itemize}
	\item $O(n \cdot m \cdot log(m))$, m - maksymalna liczba stanów podczas planowania (lista otwartych) % n - liczba robotów, m - maksymalna liczba stanów podczas planowania w konfiguracji time-space = maksymalny rozmiar listy OPEN
\end{itemize}
% jak działa A*, A* sprowadza się do Dijkstry

\subsubsection{Wpływ układu priorytetów na długość tras}
\begin{figure}[htp]
	\centering
	\includegraphics[width=\textwidth,height=0.6\textheight,keepaspectratio]{img/article1/ppt6}
	\caption{Niezależne planowanie optymalnych tras dla 2 robotów; suboptymalne rozwiązanie, gdy robot 1 ma wyższy priorytet; rozwiązanie, gdy robot 2 ma wyższy priorytet}
\end{figure}

\section{Wybór priorytetów}
\subsubsection{Elastyczny dobór priorytetów}
Obecne techniki pozostawiają dowolny wybór priorytetów lub korzystają z ustalonego z góry stałego układu kolejności robotów. \\

\section{Podusmowanie}
\subsection{Wnioski}
\begin{itemize}
	\item Testy przeprowadzono w dwóch różnych środowiskach (acykliczne / cykliczne). Losowo generowano punktów startu i celu
	\item Zaprezentowano metodę doboru priorytetów dla rozproszonych metod planowania dróg dla grupy robotów mobilnych.
	\item Zaproponowane podejście to randomizowana metoda, która cyklicznie zamienia kolejność robotów w celu znalezienia sekwencji, dla której można wyznaczyć plan dróg oraz w celu minimalizacji całkowitej długości tras.
	\item Jest to algorytm, który może być zatrzymany w dowolnym momencie i może zawsze zwrócić obecnie najlepsze rozwiązanie.
	\item Metoda została zaimplementowana i przetestowana na rzeczywistych robotach i w rozległych testach symulacyjnych dla dwóch różnych metod planowania dróg oraz dla dużej liczby robotów.
	\item Wyniki eksperyentu pokazały, że metoda potrafi znacząco zmniejszyć liczbę niepowodzeń (gdy żadne rozwiązanie nie zostaje znalezione) i znacznie zmniejszyć całkowitą długość tras.
\end{itemize}
